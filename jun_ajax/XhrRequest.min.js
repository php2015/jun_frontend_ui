var XhrRequest=(function(){var a=function(){};a.prototype.execute=function(m){m=m||{};var c=m.url;var b=(m.method||m.type||"GET").toUpperCase();var d=m.async||true;var k=m.contentType||"application/x-www-form-urlencoded; charset=UTF-8";var i=m.dataType||"json";var f=m.data;var l;if(window.XMLHttpRequest){l=new XMLHttpRequest()}else{l=new ActiveXObject("Microsoft.XMLHTTP")}if(l.timeout){if(isNaN(m.timeout)&&m.timeout!==0){l.timeout=timeout}}if(l.ontimeout&&m.timeoutHandler){l.ontimeout=m.timeoutHandler}if(m.requestFormatHandler){f=m.requestFormatHandler(f)}else{if(m.data&&typeof(m.data)=="object"){try{JSON.stringify(m.data)}catch(h){console.log(h);console.log("仅支持Json与字符串,如果非JSON类型请转换为字符串");throw new Error("Invalid JSON :"+m.data)}}if(b==="GET"){if(f&&typeof(f)=="object"){var g=[];for(var j in f){g.push(j+"="+f[j])}if(c.indexOf("?")===-1){c+="?"+g.join("&")}else{c+="&"+g.join("&")}}}else{if(k&&k.indexOf("urlencoded")!==-1||k.indexOf("URLENCODED")!==-1){if(f&&typeof(f)=="object"){var g=[];for(var j in f){g.push(encodeURIComponent(j)+"="+encodeURIComponent(f[j]))}f=g.join("&")}}else{if(f&&typeof(f)=="object"){f=JSON.stringify(f)}}}}l.open(b,c,d);if(b!=="GET"){l.setRequestHeader("Content-Type",k)}if(m.headers){for(var j in m.headers){l.setRequestHeader(j,m.headers[j])}}l.send(f);l.onreadystatechange=function(){if(l.readyState===4){var e=l.status;if(e>=200&&e<300||e===304){if(m.resultFormatHandler){m.successHandler&&m.successHandler(m.resultFormatHandler(i,l.responseText))}else{m.successHandler&&m.successHandler((i&&i==="json")?JSON.parse(l.responseText):l.responseText)}}else{m.errorHandler&&m.errorHandler(l)}}}};a.prototype.get=function(e,d,b,c){c=c||{};c.url=e;c.successHandler=d;c.errorHandler=b;this.execute(c)};a.prototype.post=function(e,f,d,b,c){c=c||{};c.url=e;c.method="POST";c.data=f;c.successHandler=d;c.errorHandler=b;this.execute(c)};a.prototype.put=function(e,f,d,b,c){c=c||{};c.url=e;c.method="PUT";c.data=f;c.successHandler=d;c.errorHandler=b;this.execute(c)};a.prototype.deletes=function(e,f,d,b,c){c=c||{};c.url=e;c.method="DELETE";c.data=f;c.successHandler=d;c.errorHandler=b;this.execute(c)};if(a.flag){return a.flag}a.flag=new a();return a.flag})();